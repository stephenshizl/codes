#!/bin/bash

i=0
max=5
ip=172.20.116.108

sudo insmod /home/june/Dropbox/tools/awusb.ko

while true
do
	ping $ip -c 1 
	if [ $? -eq 0 ] || [ $((++i)) -ge $max ] ; then
		break;
	fi
	sleep 1
done

if [ $i -eq $max ] ; then
	exit 0
fi

if [ "$1" == "umount" ] ; then
	sudo umount /home/june/newsev/
	sudo umount /home/june/share/zhangtiangui/
	sudo umount /home/june/share/zhoushaoqing/
	sudo umount /home/june/share/skyworthauto/
	sudo umount /home/june/share/liyong/
	exit 0
fi

SKY_IP="172.20.116.108"
SKY_USER="sme01249"
SKY_PASSWD="sme.01249"
SKY_MOUNT_RW="username=${SKY_USER},password=${SKY_PASSWD},rw,file_mode=0644,dir_mode=0755,uid=1000,gid=1000"
SKY_MOUNT_RO="username=${SKY_USER},password=${SKY_PASSWD},ro,file_mode=0644,dir_mode=0755,uid=1000,gid=1000"

#mount  rw
sudo mount -t cifs //$SKY_IP/$SKY_USER /home/june/newsev/ -o $SKY_MOUNT_RW
#mount  ro
sudo mount -t cifs //$SKY_IP/sme01230 /home/june/share/liyong/ -o $SKY_MOUNT_RO
sudo mount -t cifs //$SKY_IP/sme00389 /home/june/share/zhangtiangui/ -o $SKY_MOUNT_RO
sudo mount -t cifs //$SKY_IP/sme01234 /home/june/share/zhoushaoqing/ -o $SKY_MOUNT_RO
sudo mount -t cifs //$SKY_IP/skyworthauto /home/june/share/skyworthauto/ -o $SKY_MOUNT_RO

